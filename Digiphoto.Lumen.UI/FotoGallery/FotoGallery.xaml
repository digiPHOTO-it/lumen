<lumM:UserControlBase x:Class="Digiphoto.Lumen.UI.FotoGallery"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:lum="clr-namespace:Digiphoto.Lumen.UI"
             xmlns:lumM="clr-namespace:Digiphoto.Lumen.UI.Mvvm"
             xmlns:lumMS="clr-namespace:Digiphoto.Lumen.UI.Mvvm.MultiSelect"
             xmlns:extToolkit="http://schemas.microsoft.com/winfx/2006/xaml/presentation/toolkit/extended"
             xmlns:lumC="clr-namespace:Digiphoto.Lumen.UI.Converters"
             xmlns:lumD="clr-namespace:Digiphoto.Lumen.UI.Diapo"         
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="800" FontStretch="Condensed">

    <!-- Istanzio il controllore -->
    <lumM:UserControlBase.DataContext>
        <lum:FotoGalleryViewModel />
    </lumM:UserControlBase.DataContext>

	<UserControl.Resources>
		<ResourceDictionary>
			<ResourceDictionary.MergedDictionaries>
				<ResourceDictionary Source="/Resources/GlobalResourceDictionary.xaml" />
				<ResourceDictionary Source="FotoGalleryResources.xaml" />
			</ResourceDictionary.MergedDictionaries>
		</ResourceDictionary>
	</UserControl.Resources>

    <DockPanel>
        
        <ToolBarTray DockPanel.Dock="Left" Orientation="Vertical">
            
            <ToolBar>
                <Button Command="{Binding mandareInModificaCommand}" ToolTip="aggiunge alla lista delle foto da modificare" >
                    <Image Source="/Digiphoto.Lumen.UI;component/Resources/PhotoEdit-48x48.png" />
                </Button>
                <Separator />
                
                <Button Command="{Binding Path=aggiungereAlMasterizzatoreCommand}" ToolTip="Aggiungi al masterizzatore">
                    <Image Source="/Digiphoto.Lumen.UI;component/Resources/DvdBurn-48x48.png"  />
                </Button>
            </ToolBar>
            
			<ToolBar Name="stampaProvini" IsEnabled="{Binding Path=stampantiAbbinate, Converter={StaticResource listVisibilityConverter}}">
                <Button Command="{Binding Path=stampareProviniCommand}" ToolTip="Stampa provini">
                    <Image Source="/Digiphoto.Lumen.UI;component/Resources/Provini-48x48.png"  />
                </Button>            
            </ToolBar>
			
            <ToolBar Name="stampaToolBar" 
                     Header="Stampe"
                     ItemsSource="{Binding stampantiAbbinate}" 
                     ItemTemplate="{StaticResource pulsanteDiStampaTemplate}" >                
            </ToolBar>

        </ToolBarTray>

        <Expander DockPanel.Dock="Top" Header="Metadati da imporre" IsExpanded="False" ExpandDirection="Down">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition />
                    <ColumnDefinition />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                
                <StackPanel Orientation="Vertical" Grid.Row="0" Grid.Column="0">
                    <Label>Didascalia</Label>
					<TextBox Text="{Binding Path=metadati.didascalia}" CharacterCasing="Upper" MinWidth="80" />
                </StackPanel>

                <GroupBox Header="Fasi del giorno" Grid.Row="0" Grid.Column="1">
                    <ListBox ItemsSource="{Binding fasiDelGiorno}" 
                         SelectedItem="{Binding Path=metadati.faseDelGiorno}" />
                </GroupBox>

                <lum:SelettoreEvento x:Name="selettoreEventoMetadato" Grid.Column="2" MaxHeight="200"
                                     DataContext="{Binding selettoreEventoMetadato}" possoCreare="True"/>

                <StackPanel Grid.Column="3" Orientation="Vertical">
                    <Button Content="Elimina metadati" ToolTip="Elimina tutti i metadati dalle fotografie selezioanate" Command="{Binding eliminareMetadatiCommand}" Height="20" FontStretch="ExtraCondensed" />
                    <Separator />
                    <Button Content="Applica Metadati" ToolTip="Salva metadati fotografie selezionate" Command="{Binding applicareMetadatiCommand}" Height="40" />
                </StackPanel>
                
            </Grid>
        </Expander>
        
        
        <Expander DockPanel.Dock="Right" Header="View" IsExpanded="True" ExpandDirection="Left">
            
            <ToolBarTray Background="White" Orientation="Vertical">
                
                <ToolBar Band="1" BandIndex="1" >
                    <RadioButton Content="*" Tag="1" Style="{StaticResource {x:Type ToggleButton}}" Width="32" Checked="radioButtonQuanteNeVedo_Checked" />
                    <RadioButton Content="**" Tag="2" Style="{StaticResource {x:Type ToggleButton}}" Width="32"  Checked="radioButtonQuanteNeVedo_Checked" />
                    <RadioButton Content="***" Tag="4" Style="{StaticResource {x:Type ToggleButton}}" Width="32"  Checked="radioButtonQuanteNeVedo_Checked" />
                    <Slider Name="dimensioneIconeSlider" 
                            Minimum="32" Maximum="2000"
                            Orientation="Vertical" Height="50" 
                            Value="{Binding Path=dimensioneIconaFoto,Mode=TwoWay}"
                            HorizontalAlignment="Center" />
                    <Separator />
                    <Button Content="+Selez" Command="{Binding selezionareTuttoCommand}" CommandParameter="True" />
                    <Button Content="-Deselez" Command="{Binding selezionareTuttoCommand}" CommandParameter="False" />
                    <RadioButton Content="All"  Style="{StaticResource {x:Type ToggleButton}}"  Width="32" GroupName="vediSelezGrp" ToolTip="Vedi tutte le foto" Command="{Binding Path=filtrareSelezionateCommand}" CommandParameter="false" />
                    <RadioButton Content="Selez" Style="{StaticResource {x:Type ToggleButton}}"  Width="32" GroupName="vediSelezGrp" ToolTip="Vedi solo le foto selezionate" Command="{Binding Path=filtrareSelezionateCommand}" CommandParameter="true" />
                   
                   
                </ToolBar>

                <ToolBar Band="2" BandIndex="2" Header="Pubblico">
                    <Button Content="Load" Command="{Binding caricareSlideShowCommand}" CommandParameter="Manual" />
                    <ToggleButton Content="Start" Command="{Binding controllareSlideShowCommand}" CommandParameter="Start" />
                    <ToggleButton Content="Stop"  Command="{Binding controllareSlideShowCommand}" CommandParameter="Stop" />
                    <extToolkit:IntegerUpDown Minimum="1" Maximum="10" ToolTip="Num. righe Slide-Show" Value="{Binding numRigheSlideShow}" />
                    <extToolkit:IntegerUpDown Minimum="1" Maximum="10" ToolTip="Num. colonne Slide-Show" Value="{Binding numColonneSlideShow}" />
                    <Separator />
                    <Button Content="Svuota" Command="{Binding controllareSlideShowCommand}" CommandParameter="Reset" />
                </ToolBar>
            </ToolBarTray>
        </Expander>

        <StatusBar DockPanel.Dock="Bottom" >
            <StatusBarItem>
                <StackPanel Orientation="Horizontal">
                    <Label Content="Selez: " />
                    <Label Content="{Binding Path=fotografieCW.SelectedItems.Count}" ToolTip="Foto selezionate"/>
                    <Label Content="/" />
                    <Label Content="{Binding Path=fotografieCW.Count}" ToolTip="Tutte le foto visualizzate" />
                </StackPanel>
            </StatusBarItem>
            <StatusBarItem>
                <Image Source="{Binding statusSlideShowImage}" Width="16" Height="16" ToolTip="Stato dello Slide Show" />
            </StatusBarItem>
        </StatusBar>
        
        <Expander Header="Ricerca foto nell'archivio" DockPanel.Dock="Bottom" IsExpanded="True" ExpandDirection="Up">
            
            <StackPanel Orientation="Horizontal">
                
                <GroupBox Header="Tempo">

                    <StackPanel Orientation="Horizontal">

                        <StackPanel Orientation="Vertical">
                            <Label Content="Scegliere data inizio e fine"  ToolTip="Cliccare sulla prima data poi scorrere fino alla seconda senza lasciare"/>
                            <Calendar SelectionMode="SingleRange" Name="calendario" SelectedDatesChanged="calendario_SelectedDatesChanged" />
                        </StackPanel>

                        <StackPanel Orientation="Vertical">
                            <Button Content="Oggi" Name="oggiButton" Click="oggiButton_Click" />
                            <Button Content="Ieri" Name="ieriButton" Click="ieriButton_Click" />
                            <Button Content="Ieri e Oggi" Name="ieriOggiButton" Click="ieriOggiButton_Click" />
                        </StackPanel>
                        
                    </StackPanel>
                </GroupBox>


                
                
                <!-- eventuale filtro per fotografo -->
                <lum:SelettoreFotografo x:Name="selettoreFotografo5" possoCreare="False"
                                        DataContext="{Binding selettoreFotografoViewModel}" />

                <lum:SelettoreEvento x:Name="selettoreEvento5" possoCreare="False"
                                 DataContext="{Binding selettoreEventoFiltro}" />

                <StackPanel Orientation="Vertical">
                    <CheckBox Name="checkBoxMattino" Content="Mattino" IsChecked="{Binding isMattinoChecked,Mode=TwoWay}"  />
                    <CheckBox Name="checkBoxPomeriggio" Content="Pomeriggio" IsChecked="{Binding isPomeriggioChecked,Mode=TwoWay}"  />
                    <CheckBox Name="checkBoxSera" Content="Sera" IsChecked="{Binding isSeraChecked,Mode=TwoWay}" />              
                    
                    <Separator />
                    
                    <Label Content="Didascalia" />
					<TextBox Name="didascaliaTextBox" CharacterCasing="Upper" Text="{Binding Path=paramCercaFoto.didascalia,Mode=TwoWay}" />

                    <Separator />
                    
                    <Label>Numeri</Label>
					<TextBox  Text="{Binding Path=stringaNumeriFotogrammi}" 
							  Name="textBoxNumFotogrammi"
							  CharacterCasing="Upper"
							  ToolTip="Indicare i numeri separati da virgola ," />
                </StackPanel>
                
        
                
                <Button Name="azzeraParamRicercaButton" Content="Azzera param" ToolTip="Azzera i parametri di ricerca" Command="{Binding azzeraParamRicercaCommand}" />
                <Button Name="eseguireRicercaButton" Content="Esegui Ricerca" Command="{Binding eseguireRicercaCommand}" />
                <Button Name="caricareSlideShowAuto" Content="Load SS Auto" Command="{Binding caricareSlideShowCommand}" CommandParameter="Auto" />
                
            </StackPanel>
            
           
        </Expander>


        
        
        <!-- Questa è la lista delle immagini -->
        <ListBox x:Name="LsImageGallery"  
                 SelectionMode="Multiple" 
                 lumMS:MultiSelect.IsEnabled="True" IsSynchronizedWithCurrentItem="True"
                 Style="{StaticResource LsImageGalleryStyle}"
                 ItemsSource="{Binding Path=fotografieCW}" 
                 ItemsPanel="{DynamicResource ImageGalleryItemsPanelTemplate}" 
                 ItemTemplate="{DynamicResource fotografiaDataTemplate}"
            ScrollViewer.HorizontalScrollBarVisibility="Disabled" PreviewMouseRightButtonDown="LsImageGallery_PreviewMouseRightButtonDown">

                <ListBox.ItemContainerStyle>
                    <Style TargetType="{x:Type ListBoxItem}">
                    <EventSetter Event="MouseDoubleClick" Handler="listBoxItemImageGallery_MouseDoubleClick" />
                    </Style>
                </ListBox.ItemContainerStyle>
			<ListBox.ContextMenu>
				<ContextMenu >
					<MenuItem Header="Stampa"
							ItemsSource="{Binding stampantiAbbinate}" 
							ItemTemplate="{StaticResource stampaRapidaMenu}" >
					</MenuItem>
					<MenuItem Header="Vedi a tutto schermo"
                              Command="{Binding Path=viewFotoFullScreenCommand}" />
					<MenuItem Header="Elimina" 
                              Command="{Binding Path=eliminareFotoCommand}"
                              CommandParameter="SEL" />
                    
				</ContextMenu>
			</ListBox.ContextMenu>

		</ListBox>

    </DockPanel>

</lumM:UserControlBase>